<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Debug Console SIDCF</title>
  <link rel="stylesheet" href="css/variables.css">
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/components.css">
  <style>
    body { padding: 20px; }
    #console {
      background: #1f2937;
      color: #f3f4f6;
      padding: 16px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      height: 400px;
      overflow-y: auto;
    }
    .log-entry { margin: 4px 0; }
    .log-info { color: #3b82f6; }
    .log-error { color: #ef4444; font-weight: bold; }
    .log-warn { color: #f59e0b; }
  </style>
</head>
<body>
  <h1>üîç Console de Debug SIDCF</h1>
  <div id="console"></div>

  <script type="module">
    const consoleEl = document.getElementById('console');

    function log(type, ...args) {
      const entry = document.createElement('div');
      entry.className = `log-entry log-${type}`;
      entry.textContent = `[${type.toUpperCase()}] ${args.join(' ')}`;
      consoleEl.appendChild(entry);
      consoleEl.scrollTop = consoleEl.scrollHeight;
    }

    // Intercepter console
    const originalLog = console.log;
    const originalError = console.error;
    const originalWarn = console.warn;

    console.log = (...args) => {
      originalLog(...args);
      log('info', ...args);
    };

    console.error = (...args) => {
      originalError(...args);
      log('error', ...args);
    };

    console.warn = (...args) => {
      originalWarn(...args);
      log('warn', ...args);
    };

    log('info', '=== D√©marrage du boot ===');

    try {
      // Importer et ex√©cuter boot
      const bootModule = await import('./js/main.js');
      log('info', 'Module main.js charg√©');

      // Attendre 12s pour voir les logs
      setTimeout(() => {
        log('info', '=== Fin du timeout 12s ===');
        const app = document.getElementById('app');
        if (app) {
          const hasLoader = app.querySelector('.loading-screen');
          log(hasLoader ? 'error' : 'info', `Loader visible: ${!!hasLoader}`);
        }
      }, 12000);

    } catch (error) {
      log('error', `Erreur import main.js: ${error.message}`);
      log('error', error.stack);
    }
  </script>

  <!-- Conteneurs n√©cessaires -->
  <header id="topbar" style="display: none;"></header>
  <div class="layout" style="display: none;">
    <aside id="sidebar"></aside>
    <main id="app">
      <div class="loading-screen">
        <div class="spinner"></div>
        <p>Chargement...</p>
      </div>
    </main>
  </div>
</body>
</html>
